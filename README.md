# Voice Messages Type Detection

–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–∏–ø–∞ –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (—Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π / –Ω–µ—Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å) —Å –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–µ–π –∞—É–¥–∏–æ –≤ —Ç–µ–∫—Å—Ç –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π —Å Telegram-–±–æ—Ç–æ–º.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞
```
bot/             # —Ç–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç
server/          # FastAPI: /health, /supported_formats, /predict, /models
ml/              # –æ–±—É—á–µ–Ω–∏–µ –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã
models/          # –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –º–æ–¥–µ–ª–µ–π –∏ config.json
docs/            # –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (FIX_*, DEPLOY, QUICK_START –∏ –¥—Ä.)
scripts/         # —Å–∫—Ä–∏–ø—Ç—ã –∑–∞–ø—É—Å–∫–∞ –∏ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è
notebooks/       # –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –Ω–æ—É—Ç–±—É–∫–∏
data/            # –¥–∞—Ç–∞—Å–µ—Ç—ã
```
–î–∏–∞–≥—Ä–∞–º–º–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ –Ω–µ –≤–∫–ª—é—á–µ–Ω–∞.

## –ó–∞–ø—É—Å–∫
1) –£—Å—Ç–∞–Ω–æ–≤–∫–∞ (–≤—Ä—É—á–Ω—É—é –∏–ª–∏ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç):
```bash
python -m venv .venv && source .venv/bin/activate
pip install -r requirements.txt
cp .env.example .env
```
–ò–ª–∏ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π: `./scripts/deploy.sh`
2) –û–±—É—á–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä—Å–∫–æ–π –º–æ–¥–µ–ª–∏ (–ø—Ä–∏–º–µ—Ä):
```bash
python ml/train_daybov_model.py --data data/train.csv --outdir models/
```
3) –°–µ—Ä–≤–µ—Ä:
```bash
uvicorn server.main:app --host 0.0.0.0 --port 8000 --reload
```
–ò–ª–∏: `./scripts/start_server.sh`
4) –¢–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç:
```bash
python -m bot.bot
```
–ò–ª–∏: `./scripts/start_bot.sh`. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –±–æ—Ç–∞ –≤–º–µ—Å—Ç–µ: `./scripts/start_all.sh`, –æ—Å—Ç–∞–Ω–æ–≤–∫–∞: `./scripts/stop_all.sh`. –ü–æ–¥—Ä–æ–±–Ω–µ–µ ‚Äî –≤ `scripts/README.md`.

## –û–±—É—á–µ–Ω–∏–µ –∏ –º–µ—Ç—Ä–∏–∫–∏
–°–∫—Ä–∏–ø—Ç—ã –≤ `ml/`:
- `train_daybov_model.py` ‚Äî Daybov TF‚ÄëIDF+LR.
- `train_classic.py` ‚Äî –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è, SVM, Naive Bayes.
- `train_cnn.py` ‚Äî CNN (PyTorch).
- `train_transformer.py` ‚Äî —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä—ã (HF).
- `evaluate.py` ‚Äî –æ—Ü–µ–Ω–∫–∞ sklearn‚Äë–º–æ–¥–µ–ª–µ–π.

–ú–µ—Ç—Ä–∏–∫–∏ (test): macro‚ÄëF1, accuracy, weighted‚ÄëF1, ROC‚ÄëAUC (–¥–ª—è –±–∏–Ω–∞—Ä–Ω–æ–π), PR‚ÄëAUC, confusion matrix.

## ASR
–í—ã–±–æ—Ä –±—ç–∫–µ–Ω–¥–∞ –≤ `.env` —á–µ—Ä–µ–∑ `ASR_BACKEND`: `speech_recognition`, `vosk`, `whisper`.
–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ WAV 16 kHz mono –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (FFmpeg).

## ü§ñ –í–µ—Ä—Å–∏—è 2.0: –í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –º–æ–¥–µ–ª–∏

#### –û–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ (–Ω–∞ –Ω–∞—à–µ–º –¥–∞—Ç–∞—Å–µ—Ç–µ)
| –ú–æ–¥–µ–ª—å | –û–ø–∏—Å–∞–Ω–∏–µ | Macro-F1 |
|--------|----------|----------|
| Logistic Regression | –ë—ã—Å—Ç—Ä–∞—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å | X.XX |
| SVM | Support Vector Machine | X.XX |
| Naive Bayes | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω–∞—è –º–æ–¥–µ–ª—å | X.XX |
| Random Forest | –ê–Ω—Å–∞–º–±–ª—å –¥–µ—Ä–µ–≤—å–µ–≤ | X.XX |
| BiLSTM | –î–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è LSTM | X.XX |
| CNN | –°–≤—ë—Ä—Ç–æ—á–Ω–∞—è –Ω–µ–π—Ä–æ—Å–µ—Ç—å | X.XX |
| BERT | Fine-tuned rubert-tiny2 | X.XX |
| Ensemble | –í–∑–≤–µ—à–µ–Ω–Ω—ã–π –∞–Ω—Å–∞–º–±–ª—å | X.XX |

#### Pretrained –º–æ–¥–µ–ª–∏ (HuggingFace)
| –ú–æ–¥–µ–ª—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|
| XLM-R Formality | Multilingual –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ñ–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏ |
| RuBERT Sentiment | Sentiment –∫–∞–∫ –ø—Ä–æ–∫—Å–∏ –¥–ª—è —Å—Ç–∏–ª—è |

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –±–æ—Ç–µ

1. `/start` - –Ω–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã
2. `/model` - –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
3. `/info` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª–∏
4. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –≥–æ–ª–æ—Å–æ–≤–æ–µ –∏–ª–∏ —Ç–µ–∫—Å—Ç –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

### API

```bash
# –°–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π
curl http://localhost:8000/models

# –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞
curl -X POST http://localhost:8000/predict_text \
  -F "text=–£–≤–∞–∂–∞–µ–º—ã–π –∫–æ–ª–ª–µ–≥–∞, –ø—Ä–æ—à—É —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å" \
  -F "model=ensemble"

# –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∞—É–¥–∏–æ
curl -X POST http://localhost:8000/predict \
  -F "file=@audio.ogg" \
  -F "model=bert"
```

## Telegram-–±–æ—Ç
–ü—Ä–∏–Ω–∏–º–∞–µ—Ç –≥–æ–ª–æ—Å–æ–≤—ã–µ/–∞—É–¥–∏–æ—Ñ–∞–π–ª—ã, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ `/predict`, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–∏. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–ª–∞—Å—Å, —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —á–∏—Å–ª–æ —Å–ª–æ–≤ –∏ –ø—Ä–µ–≤—å—é —Ç–µ–∫—Å—Ç–∞.

## –ê–Ω—Å–∞–º–±–ª—å
–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è `models/ensemble.json`:
```json
{
  "models": ["daybov", "logreg", "cnn", "bert"],
  "weights": {"daybov": 1.2, "logreg": 1.0, "cnn": 0.8, "bert": 1.3}
}
```

## –§–æ—Ä–º–∞—Ç –¥–∞—Ç–∞—Å–µ—Ç–∞
CSV:
```csv
text,label
"–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, –ø–æ–¥—Å–∫–∞–∂–∏—Ç–µ —Å—Ç–∞—Ç—É—Å...",formal
"–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?",informal
```

## –ü—É–±–ª–∏–∫–∞—Ü–∏—è –≤ GitHub
```bash
git init
git add .
git commit -m "Initial commit"
git branch -M main
git remote add origin https://github.com/DimaDaybov/voice-messages-type-detection.git
git push -u origin main
```

## –õ–∏—Ü–µ–Ω–∑–∏—è
MIT.
