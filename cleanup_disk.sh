#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –¥–∏—Å–∫–∞ –ø–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π PyTorch –∏ Whisper

set -e

echo "üßπ –ù–∞—á–∞–ª–æ –æ—á–∏—Å—Ç–∫–∏ –¥–∏—Å–∫–∞..."

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
echo ""
echo "üìä –¢–µ–∫—É—â–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞:"
df -h / | tail -1

# 1. –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ pip
echo ""
echo "1Ô∏è‚É£ –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ pip..."
pip cache purge 2>/dev/null || true
rm -rf ~/.cache/pip 2>/dev/null || true
echo "‚úÖ –ö—ç—à pip –æ—á–∏—â–µ–Ω"

# 2. –û—á–∏—Å—Ç–∫–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –∫—ç—à–∞
echo ""
echo "2Ô∏è‚É£ –û—á–∏—Å—Ç–∫–∞ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –∫—ç—à–∞..."
sudo apt-get clean 2>/dev/null || true
sudo apt-get autoclean 2>/dev/null || true
sudo apt-get autoremove -y 2>/dev/null || true
echo "‚úÖ –°–∏—Å—Ç–µ–º–Ω—ã–π –∫—ç—à –æ—á–∏—â–µ–Ω"

# 3. –û—á–∏—Å—Ç–∫–∞ Docker (–µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
echo ""
echo "3Ô∏è‚É£ –û—á–∏—Å—Ç–∫–∞ Docker (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)..."
if command -v docker &> /dev/null; then
    docker system prune -a --volumes -f 2>/dev/null || true
    echo "‚úÖ Docker –æ—á–∏—â–µ–Ω"
else
    echo "‚ö†Ô∏è  Docker –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º"
fi

# 4. –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤
echo ""
echo "4Ô∏è‚É£ –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤..."
journalctl --vacuum-time=1d 2>/dev/null || true
echo "‚úÖ –õ–æ–≥–∏ –æ—á–∏—â–µ–Ω—ã (–æ—Å—Ç–∞–≤–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–Ω—å)"

# 5. –û—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
echo ""
echo "5Ô∏è‚É£ –û—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤..."
rm -rf /tmp/* 2>/dev/null || true
rm -rf /var/tmp/* 2>/dev/null || true
echo "‚úÖ –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –æ—á–∏—â–µ–Ω—ã"

# 6. –ü–æ–∏—Å–∫ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
echo ""
echo "6Ô∏è‚É£ –ü–æ–∏—Å–∫ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π..."
echo "–¢–æ–ø-10 —Å–∞–º—ã—Ö –±–æ–ª—å—à–∏—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –≤ /root:"
du -sh /root/* 2>/dev/null | sort -h | tail -10 || true

echo ""
echo "–¢–æ–ø-10 —Å–∞–º—ã—Ö –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ –≤ /var/log:"
du -sh /var/log/* 2>/dev/null | sort -h | tail -10 || true

# –ò—Ç–æ–≥–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
echo ""
echo "üìä –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞ –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏:"
df -h / | tail -1

echo ""
echo "‚úÖ –û—á–∏—Å—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!"
